<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simón Dice</title>
    <style>
        body {
          margin: 0;
          background: #dedede;
          display: flex;
          align-items: center;
          height: 100vh;
        }
  
        .gameboard {
          height: 100vh;
          width: 100vh;
          border-radius: 50%;
          overflow: hidden;
          margin: 0 auto;
          max-height: 60vh;
          max-width: 60vh;
        }
  
        .color {
          width: 50%;
          height: 50%;
          display: inline-block;
        }
  
        .left {
          float: left;
        }
  
        .right {
          float: left;
        }
  
        .celeste {
          background: #22a6b3;
        }
  
        .celeste.light {
          background: #7ed6df;
        }
  
        .violeta {
          background: #be2edd;
        }
  
        .violeta.light {
          background: #e056fd;
        }
  
        .naranja {
          background: #f0932b;
        }
  
        .naranja.light {
          background: #ffbe76;
        }
  
        .verde {
          background: #6ab04c;
        }
  
        .verde.light {
          background: #badc58;
        }
  
        .btn-start {
          width: 400px;
          height: 100px;
          background: #ecf0f1;
          color: #2c3e50;
          font-size: 2.5rem;
          position: absolute;
          top: calc(50% - 50px);
          left: calc(50% - 200px);
          transition: 500ms;
        }
  
        .hide {
          display: none;
        }
      </style>
    </head>
    <body>
      <div class="gameboard">
        <div id="celeste" class="color celeste left" data-color="celeste"></div>
        <div id="violeta" class="color violeta right" data-color="violeta"></div>
        <div id="naranja" class="color naranja left" data-color="naranja"></div>
        <div id="verde" class="color verde right" data-color="verde"></div>
        <button id="btnEmpezar" class="btn-start" onclick="empezarJuego()">Empezar a jugar!</button>
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
      <script>
        const celeste = document.getElementById('celeste')
        const violeta = document.getElementById('violeta')
        const naranja = document.getElementById('naranja')
        const verde = document.getElementById('verde')
        const btnEmpezar = document.getElementById('btnEmpezar')
        const ULTIMO_NIVEL = 10
  
        class Juego {//esta clase va a tener toda la logica del juego
          constructor() { //this para el caso se refiere a la partida
            this.inicializar()
            this.generarSecuencia()
          setTimeout(()=>{
            this.siguienteNivel()
          },500)
          }
  
          inicializar() {
            btnEmpezar.classList.add('hide')//oculta el boton de inicio
            this.nivel=1
            this.colores={
                celeste,
                violeta,
                naranja,
                verde
              //para el caso JavaScript toma el valor de los elementos del objeto igual que el titulo
              // celeste: celeste es igual a solo poner celeste

            }
          }
          generarSecuencia(){
              this.secuencia= new Array(ULTIMO_NIVEL).fill(0).map(n => Math.floor(Math.random()*4))
              //se crea un array de secuencias, primer argumento, tamaño de array
              //se llama fill para definir todos los elementos del array en 0
              //map le realiza algo a cada uno de los elementos del array
              //math.floor redondea hacia abajo al numero (3.2=>3 , 2.8=>2)
              //math.random genera un aletatorio entre 0 y 1
              //se multiplica por 4 para que genere un valor mayor a 1 pero menor a 4
              //todo eso con el fin de generar un numero aleatorio entre 0 y 3
          }
          siguienteNivel(){
             this.elegirColor=this.elegirColor.bind(this)
             this.siguienteNivel=this.siguienteNivel.bind(this)
              this.subnivel= 0
              this.nombreatributo = 'valor'
              this.iluminarSecuencia()
              this.agregarEventosclick()

          }
            transformarNumero(numero){ /* se le da como argumento un numero para que devuelva un color */
                switch(numero){
                    case 0:
                    return 'celeste'
                    case 1:
                    return 'violeta'
                    case 2:
                    return 'naranja'
                    case 3:
                    return 'verde'

                }
            }

            transformarColor(nombreColor){ /* se le da un color para que devuelva un numero */
                switch(nombreColor){
                    case 'celeste':
                    return 0
                    case 'violeta':
                    return 1
                    case 'naranja':
                    return 2
                    case 'verde':
                    return 3

                }
            }

          iluminarSecuencia(){ /* va a iluminar los botones dependiendo del nivel que se neucentre 
          por lo que se usa un for que hace ciclos dependiendo del nivel en el que este, si esta en
          el nivel 2 hara dos ciclos, si esta en el 10 hara 10 ciclos */
              for(let i=0;i< this.nivel;i=i+1){
                const color = this.transformarNumero(this.secuencia[i]) /* se le pasa a la función
                de transformar numero cada uno de los elementos del array de secuencia segun sea el nivel
                para ello el indice de ese array es el mismo i del for */
                setTimeout(()=> this.iluminarColor(color),1000*i) /* se usa un settimeout para que no
                ilumine los colores al mismo tiempo */
              }
           }
          iluminarColor(color){
              this.colores[color].classList.add('light') /* toma el elemento que corresponde al color 
              ej:violeta y toma  su lista de clases, para agregarle la clase de lista*/
              setTimeout(()=> this.apagarColor(color),380) /* ejecuta la funcion que apaga el color
              y se le dice en que tiempo lo hago, asi va a dar la sensacion de encendido y apagado */

          }
          apagarColor(color){
            this.colores[color].classList.remove('light')/* toma el elemento color del html y su lista
            de clases para eliminar la clase light es decir, apaga el boton */
          }
          agregarEventosclick(){
              this.colores.celeste.addEventListener('click',this.elegirColor) /* bind ata le clase Juego a la propiedad this */
              this.colores.violeta.addEventListener('click',this.elegirColor)
              this.colores.naranja.addEventListener('click',this.elegirColor)
              this.colores.verde.addEventListener('click',this.elegirColor)
            }
            eliminarEvenetosClick(){
              this.colores.celeste.removeEventListener('click',this.elegirColor) /* bind ata le clase Juego a la propiedad this */
              this.colores.violeta.removeEventListener('click',this.elegirColor)
              this.colores.naranja.removeEventListener('click',this.elegirColor)
              this.colores.verde.removeEventListener('click',this.elegirColor)

            }
          elegirColor(ev){
              const nombreColor = ev.target.dataset.color
              
              const numeroColor= this.transformarColor(nombreColor)
              this.iluminarColor(nombreColor)
              if (numeroColor===this.secuencia[this.subnivel]){
               this.subnivel+=1
                if(this.subnivel===this.nivel){
                    this.nivel+=1
                    this.eliminarEvenetosClick()
                    if(this.nivel===(ULTIMO_NIVEL+1)){
                       this.ganojuego()
                    } else {
                        setTimeout(this.siguienteNivel, 1500)
                    }

                }
              }else{
                console.log(this.secuencia)
                console.log(this.subnivel)
                console.log(numeroColor)
                
                this.perdiojuego()

              }
            }
        
            ganojuego(){
                swal('Simon dice:','Felicidades, Ganaste!!','success')
                .then(()=>{
                    this.eliminarEvenetosClick()
                    btnEmpezar.classList.remove('hide')
                })
            }
            perdiojuego(){
                swal('Simon dice:','vuelve a intentarlo','error')
                .then(()=>{
                    this.eliminarEvenetosClick()
                    btnEmpezar.classList.remove('hide')
                })
            }
        }

  
        function empezarJuego() { //función que se ejecuta al clickear el botón
          var juego = new Juego()// se crea un elemento por medio de una clase (nueva partida)
        }

       
      </script>
    </body>
  </html>