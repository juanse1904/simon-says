<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Ranchers&display=swap" rel="stylesheet">
    <title>Simón Dice</title>
    <style>
        body {
          margin: 0;
          background: #dedede;
          
          align-items: center;
          height: 100vh;
        }
  
        .gameboard {
          height: 100vh;
          width: 100vh;
          overflow: hidden;
          margin: 0 auto;
          max-height: 60vh;
          max-width: 60vh;
        }
  
        .color {
          width: 50%;
          height: 50%;
          display: inline-block;
        }
  
        .left {
          float: left;
        }
  
        .right {
          float: left;
        }
  
        .celeste {
          background: #2261b3;
          transition: 700ms;
          border-top-left-radius: 100%;
          box-shadow: inset 7px 7px 7px rgba(255,255,255,.7), inset -2px -2px 3px rgba(0,0,0,.1), 2px 2px 10px rgba(0,0,0,.1);

        }
        .violeta.pushed{
          box-shadow:inset 4px 4px 4px rgba(0,0,0,.3), inset -3px -3px 3px rgba(255,255,255,.2);
          background: #194988;
        }
  
        .celeste.light {
          background: #59a0fd;
        }
  
        .violeta {
          background: #b81848;
          transition: 500ms;
          border-top-right-radius: 100%;
          box-shadow: inset -7px 7px 7px rgba(255,255,255,.7), inset -2px -2px 3px rgba(0,0,0,.1), 2px 2px 10px rgba(0,0,0,.1);
          
        }
        .violeta.pushed{
          box-shadow:inset -4px 4px 4px rgba(0,0,0,.3), inset -3px -3px 3px rgba(255,255,255,.2);
          background: #8b1236;
        }
        .violeta.light {
          background: #ff769f;
        }
  
        .naranja {
          background: #f0e32b;
          transition: 500ms;
          border-bottom-left-radius: 100%;
          box-shadow: inset 7px -7px 7px rgba(255,255,255,.7), inset -2px -2px 3px rgba(0,0,0,.1), 2px 2px 10px rgba(0,0,0,.1);
        }
        .naranja.pushed{
          box-shadow:inset 4px -4px 4px rgba(0,0,0,.3), inset -3px -3px 3px rgba(255,255,255,.2);
          background: #a1981c;
        }
  
        .naranja.light {
          background: #fff99f;
        }
  
        .verde {
          background: #31b437;
          transition: 500ms;
          border-bottom-right-radius: 100%;
          box-shadow: inset -7px -7px 7px rgba(255,255,255,.7), inset -2px -2px 3px rgba(0,0,0,.1), 2px 2px 10px rgba(0,0,0,.1);
        }
        .verde.pushed{
          box-shadow:inset -4px -4px 4px rgba(0,0,0,.3), inset -3px -3px 3px rgba(255,255,255,.2);
          background: rgb(46, 83, 30);
        }
  
        .verde.light {
          background: #71e477;
        }
  
        .btn-start {
          width: 40%;
          height: 70px;
          border-radius: 30px;
          background: #ecf0f1;
          color: #2c3e50;
          font-size: 1.8em;
          display:block;
          transition: 500ms;
          margin-left: auto;
          margin-right:auto;
        }
  
        .hide {
          display: none;
        }
        .smaller{
          transform:scale(0.85);
        }
        h1{
          font-family: 'Ranchers', cursive;
          font-size: 3.5em;
          text-align: center;
          
        }
        h2{
          font-size: 3.5em;
          text-align: center; 
        }
        .information{
          margin-top: 70px;
        }
        .footer{
          display:grid;
          grid-template-columns: 1fr 1fr;
          background-color: #194988;
          font-size: 2.0em;
          max-height: 300px;
          margin-top: 30px;
        }
        .logo{
          height:70%;
          margin:20px;
          justify-self:end;
          filter:invert(1);
        }
        #dev{
          margin-left: 20px;
          color: white;
        }
        @media only screen and (max-width: 600px) {
          .btn-start {
          width: 80%;
         }
} 
      </style>
     <audio id="sound" src=""></audio>
    </head>
    <body>
      <div class="information">

        <h1>Simon Says</h1>
        <h2>Nivel:</h2>
        <h2 id="nivel">0</h2>
      </div> 
      <button id="btnEmpezar" class="btn-start" onclick="empezarJuego()">Empezar a jugar!</button>
      <div class="gameboard">
        <div id="celeste" class="color celeste left" data-color="celeste"></div>
        <div id="violeta" class="color violeta right" data-color="violeta"></div>
        <div id="naranja" class="color naranja left" data-color="naranja"></div>
        <div id="verde" class="color verde right" data-color="verde"></div>
      </div>
      <footer class="footer">
        <p id="dev">developer By:</p>
        <img class="logo" src="./assets/logo.png" alt="">
      </footer>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
      <script>
        const celeste = document.getElementById('celeste')
        const violeta = document.getElementById('violeta')
        const naranja = document.getElementById('naranja')
        const verde = document.getElementById('verde')
        const level = document.getElementById('nivel')
        const btnEmpezar = document.getElementById('btnEmpezar')
        const ULTIMO_NIVEL = 10
  
        class Juego {//esta clase va a tener toda la logica del juego
          constructor() { //this para el caso se refiere a la partida
            this.inicializar()
            this.generarSecuencia()
          setTimeout(()=>{
            this.siguienteNivel()
          },500)
          }
  
          inicializar() {
            btnEmpezar.classList.add('hide')//oculta el boton de inicio
            level.innerHTML="1"
            this.nivel=1
            this.colores={
                celeste,
                violeta,
                naranja,
                verde
              //para el caso JavaScript toma el valor de los elementos del objeto igual que el titulo
              // celeste: celeste es igual a solo poner celeste

            }
          }
          generarSecuencia(){
              this.secuencia= new Array(ULTIMO_NIVEL).fill(0).map(n => Math.floor(Math.random()*4))
              //se crea un array de secuencias, primer argumento, tamaño de array
              //se llama fill para definir todos los elementos del array en 0
              //map le realiza algo a cada uno de los elementos del array
              //math.floor redondea hacia abajo al numero (3.2=>3 , 2.8=>2)
              //math.random genera un aletatorio entre 0 y 1
              //se multiplica por 4 para que genere un valor mayor a 1 pero menor a 4
              //todo eso con el fin de generar un numero aleatorio entre 0 y 3
          }
          siguienteNivel(){
             this.elegirColor=this.elegirColor.bind(this)
             this.oprimirColor=this.oprimirColor.bind(this)
             this.siguienteNivel=this.siguienteNivel.bind(this)
              this.subnivel= 0
              this.nombreatributo = 'valor'
              this.iluminarSecuencia()
              this.agregarEventosclick()

          }
            transformarNumero(numero){ /* se le da como argumento un numero para que devuelva un color */
                switch(numero){
                    case 0:
                    return 'celeste'
                    case 1:
                    return 'violeta'
                    case 2:
                    return 'naranja'
                    case 3:
                    return 'verde'

                }
            }
            generarFre(num){ /* se le da como argumento un numero para que devuelva frecuencia de sonido */
                switch(num){
                    case 0:
                    return 140.31
                    case 1:
                    return 231.6
                    case 2:
                    return 325.8
                    case 3:
                    return 438.2

                }
            }

            transformarColor(nombreColor){ /* se le da un color para que devuelva un numero */
                switch(nombreColor){
                    case 'celeste':
                    return 0
                    case 'violeta':
                    return 1
                    case 'naranja':
                    return 2
                    case 'verde':
                    return 3

                }
            }

          iluminarSecuencia(){ /* va a iluminar los botones dependiendo del nivel que se neucentre 
          por lo que se usa un for que hace ciclos dependiendo del nivel en el que este, si esta en
          el nivel 2 hara dos ciclos, si esta en el 10 hara 10 ciclos */
              for(let i=0;i< this.nivel;i=i+1){
                const color = this.transformarNumero(this.secuencia[i]) /* se le pasa a la función
                de transformar numero cada uno de los elementos del array de secuencia segun sea el nivel
                para ello el indice de ese array es el mismo i del for */
                setTimeout(()=> {
                  this.iluminarColor(color)
                  this.generarSonido(color)
                },1000*i) /* se usa un settimeout para que no
                ilumine los colores al mismo tiempo */
              }
           }
           generarSonido(color){

             let sound= document.getElementById("sound")
             sound.src="./assets/"+color+".mp3"
             sound.play()
             /* let frec= this.generarFre(num)
             
            var context = new (window.AudioContext || window.webkitAudioContext)()
            var o = context.createOscillator()
            var  g = context.createGain()
            o.type="triangle"
            o.frequency.value=frec
            o.connect(g)
            g.connect(context.destination)
            o.start()
            g.gain.exponentialRampToValueAtTime(0.00001, context.currentTime + 0.4) */
           }

          iluminarColor(color){
              this.colores[color].classList.add('light') /* toma el elemento que corresponde al color 
              ej:violeta y toma  su lista de clases, para agregarle la clase de lista*/
              setTimeout(()=> this.apagarColor(color),380) /* ejecuta la funcion que apaga el color
              y se le dice en que tiempo lo hago, asi va a dar la sensacion de encendido y apagado */
          }

          oprimirColor(color){
            this.colores[color].classList.add('pushed') /* toma el elemento que corresponde al color 
              ej:violeta y toma  su lista de clases, para agregarle la clase de lista*/
              setTimeout(()=> this.soltarColor(color),380) /* ejecuta la funcion que apaga el color
              y se le dice en que tiempo lo hago, asi va a dar la sensacion de encendido y apagado */

          }
          apagarColor(color){
            this.colores[color].classList.remove('light')/* toma el elemento color del html y su lista
            de clases para eliminar la clase light es decir, apaga el boton */
          }
          soltarColor(color){
            this.colores[color].classList.remove('pushed')/* toma el elemento color del html y su lista
            de clases para eliminar la clase light es decir, apaga el boton */
          }
          agregarEventosclick(){
              this.colores.celeste.addEventListener('click',this.elegirColor) /* bind ata le clase Juego a la propiedad this */
              this.colores.violeta.addEventListener('click',this.elegirColor)
              this.colores.naranja.addEventListener('click',this.elegirColor)
              this.colores.verde.addEventListener('click',this.elegirColor)
            }
            eliminarEvenetosClick(){
              this.colores.celeste.removeEventListener('click',this.elegirColor) /* bind ata le clase Juego a la propiedad this */
              this.colores.violeta.removeEventListener('click',this.elegirColor)
              this.colores.naranja.removeEventListener('click',this.elegirColor)
              this.colores.verde.removeEventListener('click',this.elegirColor)

            }
          elegirColor(ev){
              const nombreColor = ev.target.dataset.color
              const numeroColor= this.transformarColor(nombreColor)
              this.oprimirColor(nombreColor)
              this.generarSonido(nombreColor)
              if (numeroColor===this.secuencia[this.subnivel]){ /* si el numero del color que clickeó
              el usuario coincide con el numero que esta en el array de la secuencia generada entonces
              puede continuar */
               level.innerHTML=" "+this.nivel
               this.subnivel+=1 /* sigue el siguiente color de secuencia */
                if(this.subnivel===this.nivel){ /* si el subnivel es igual al nivel entonces se está
                en el tope del nivel, es decir si esto se cumple y el nivel es 3 es porque el usuario clikeo
                tres veces los colores correctos y pasa al siguiente nivel */
                    this.nivel+=1
                    this.eliminarEvenetosClick()
                    if(this.nivel===(ULTIMO_NIVEL+1)){ /* se llega al final del juego */
                       this.ganojuego()
                    } else {
                        setTimeout(this.siguienteNivel, 1500)
                    }

                }
              }else{
                console.log(this.secuencia)
                console.log(this.subnivel)
                console.log(numeroColor)
                
                this.perdiojuego()

              }
            }
        
            ganojuego(){
                swal('Simon dice:','Felicidades, Ganaste!!','success')
                .then(()=>{
                    this.eliminarEvenetosClick()
                    btnEmpezar.classList.remove('hide')
                })
            }
            perdiojuego(){
                swal('Simon dice:','vuelve a intentarlo','error')
                .then(()=>{
                    this.eliminarEvenetosClick()
                    btnEmpezar.classList.remove('hide')
                })
            }
        }

  
        function empezarJuego() { //función que se ejecuta al clickear el botón
          var juego = new Juego()// se crea un elemento por medio de una clase (nueva partida)
        }

       
      </script>
    </body>
  </html>